package com.study2;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

// JSON 데이터 형식 출력
@RestController
public class MemberApi {
	
    // JDBC 템플릿 객체 선언
	private JdbcTemplate jdbcTemplate;
	
    // HTTP GET 요청을 처리하는 메서드
	@GetMapping("/members")
	public List<String> members(){
        // 이메일을 오름차순으로 정렬하여 member 테이블에서 이메일 목록을 가져오는 SQL 쿼리
		String sql = "select email from member order by email";
		
        // SQL 쿼리를 실행하고 결과를 문자열 리스트로 반환
		return jdbcTemplate.queryForList(sql, String.class);	
	}
	
    // Setter 메서드를 통한 의존성 주입
	@Autowired
	public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        // 주입된 JDBC 템플릿 객체를 멤버 변수에 저장
		this.jdbcTemplate = jdbcTemplate; // 연결정보 저장
	}
}
